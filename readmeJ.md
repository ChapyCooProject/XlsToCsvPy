## Excel-CSV 変換ツール（Python版） 使用方法

### はじめに

- ExcelファイルをCSVファイルへ変換するだけのソフトウェアです。
- 本ソフトウェア「ExcelToCsvPy.exe」は、実行ファイル単体で動作します。
- XLSファイル、XLSXファイルの両方に対応しています。
- パスワード付きExcelファイルに対応しています。
- 複数シートには対応していません。
- 64bit版Windowsのみ対応しています。
- EXCELやACCESSコンポーネントなどは不要です。

### 使用方法１

1. 実行ファイル（ExcelToCsvPy.exe）を起動してください。
2. Excelファイルを選択するダイアログが表示されます。
3. 変換したいExcelファイルを選択して、開くボタンをクリックしてください。
4. パスワードの入力を求められた場合、必要であればパスワードを入力してください。
5. Excelファイルと同じ場所に、同名のCSVファイルが作成されます。

### 使用方法２

1. 実行ファイルに、変換したいExcelファイルをドラッグアンドドロップしてください。
2. パスワードの入力を求められた場合、必要であればパスワードを入力してください。
3. Excelファイルと同じ場所に、同名のCSVファイルが作成されます。

### 使用方法３（共通）

1. コマンドプロンプトを起動し、実行ファイルが存在しているディレクトリへ移動してください。
2. 変換したいExcelファイルのフルパスを引数に設定し、実行ファイルを起動してください。
   ```cmd
   ExcelToCsvPy C:\sampleXLSX.xlsx
   ```
3. パスワードの入力を求められた場合、必要であればパスワードを入力してください。
4. Excelファイルと同じ場所に、同名のCSVファイルが作成されます。

### 設定ファイル（.json）について

- 変換したいExcelファイルと同名の設定ファイル（.json）を作成しておくと、ある程度の詳細な設定が可能となります。
- 設定ファイルを使用する場合は、変換したいExcelファイルと同じ場所に配置してください。

### 設定パラメータについて

- 設定ファイルで使用できるパラメータは次の通りです。
  - `sheet_name`：読込対象とするシート名を指定。（複数不可）
  - `excel_password`：パスワード付きのExcelファイルを指定する場合はパスワードを設定。
  - `has_header`：ヘッダ行をCSVファイルに出力するか。
    - `True`:出力する
    - `False`:出力しない
  - `has_index`：行番号の列をCSVファイルに出力するか。
    - `True`:出力する
    - `False`:出力しない
  - `encoding`：CSVファイルに出力する文字コードを指定。
    - `utf_8`:文字コードにUTF8を指定
    - `shift_jis`:文字コードにShiftJISを指定
    - `その他`:Pythonに準拠する文字コードを指定
  - `sep_char`：CSVファイルに出力する際の区切り文字を指定。
    - `,`:コンマ区切り
    - `\t`:タブ区切り
    - `その他`:Pythonに準拠する文字列
  - `write_mode`：CSVファイル出力モード。
    - `w`:新規（既存は上書き）
    - `x`:新規（既存は上書き不可）
    - `a`:追記
  - `quoting`：CSVファイルに出力する際の囲み文字の設定。
    - `0`:QUOTE_MINIMAL（区切り文字、クォーテーション、改行など特別な文字を含むフィールドのみクォートする。）
    - `1`:QUOTE_ALL（全てのフィールドをクォート。）
    - `2`:QUOTE_NONNUMERIC（全ての非数値フィールドをクォート。）
    - `3`:QUOTE_NONE（全てのフィールドをクォートしない。値に含まれる区切り文字は設定されているエスケープ文字でエスケープされる。）
  - `column_mapping`：各列の定義を設定。
    - `最初の数字`：列番号
    - `csv_col_name`：CSVファイルに出力する際の列ヘッダ名。
    - `data_type`：CSVファイルに出力する際にデータ型を考慮。
      - `整数`：数値型（整数）データとして出力。
      - `小数`：数値型（小数）データとして出力。
      - `文字列`：文字列型データとして出力。
      - `日付`：日付型データを指定の書式に変換して、文字列型データとして出力。
        > fmt：日付時刻表記（CSVファイル上の表記）※表記方法はPythonに準拠します。
      - `時刻`：
        > fmt_from：変換前の表記（Excelファイル上の表記）※表記方法はPythonに準拠します。  
        > fmt_to：変換後の表記（CSVファイル上の表記）※表記方法はPythonに準拠します。

        `※Python日時表記`
        ```
        %Y：西暦年（4桁）を表す。  
        %y：西暦年（2桁）を表す。  
        %m：月を表す。  
        %d：日を表す。  
        %H：時（24時間）を表す。  
        %I：時（12時間）を表す。  
        %p：AM または PM を表す。  
        %M：分を表す。  
        %S：秒を表す。
        ```

### ダウンロード

  - 実行ファイルは、下記URLからダウンロードできます。  
    https://drive.google.com/drive/folders/1b3sa8OYJcE8Brg22wiagkk7OABDlZ1bb?usp=sharing

